# Генератор актов выполненных работ

Этот скрипт автоматически генерирует документ "Акт выполненных работ" на основе данных об использовании серверов для участников партнёрской программы.
При запуске скрипта в текущем месяце он запрашивает статистику за прошедший месяц (например, при запуске в июне - вы получите файл с данными за май), обрабатывает данные и создает документ в формате DOCX.

## Описание работы скрипта

Скрипт выполняет следующие шаги:

1. Запрашивает данные о статистике использования серверов за прошедший месяц.
2. Обрабатывает данные, вычисляя количество минут и заработанные средства для каждого сервера.
3. Форматирует данные и вставляет их в шаблон документа.
4. Создает директорию `output` (если она не существует).
5. Сохраняет сгенерированный документ в директорию `output`.

## Требования

- [Node.js](https://nodejs.org/) версии 14.x или выше
- npm (Node Package Manager)

## Установка

1. Клонируйте репозиторий или скачайте исходный код.
2. Откройте терминал (для Windows - это `cmd`).
3. Перейдите в директорию с проектом.
4. Установите необходимые зависимости:

   ```sh
   npm install
   ```

5. Создайте файл `.env` в корне проекта (либо переименуйте образец `.env.sample`) и добавьте ваш токен авторизации и фамилию/название организации партнёра:

   ```env
   BEARER_TOKEN=your_bearer_token_here
   LAST_NAME="partner_last_name"
   ```

6. Убедитесь, что в корне проекта находится шаблон документа `template.docx`. Основу можно взять из образца `template.sample.docx`, отредактировать его и переименовать в `template.docx`.

## Использование

Запустите скрипт командой:

```sh
npm run generate
```

либо, используйте вспомогательный файл (только для Windows):

```
run.bat
```

## Вопросы и ответы

### Где взять токен авторизации?

1. После авторизации, на странице https://partners.playkey.net/pages/servers откройте DevTools (например, для Google Chrome, это делается комбинацией клавиш CTRL+SHIFT+I, либо F12).

2. Далее переключайтесь на вкладку `Network` и выберите фильтр `Fetch/XHR`

3. Нажмите F5 (обновите страницу) и выберите запрос с названием `status`
   ![DevTools → Network (fetch/XHR)](https://hunterxp.ru/playkey/docs_generator/fetch.png)

4. Найдите секцию Request Headers, и внутри неё найдите поле `Authorization`, где будет содержимое вида `Bearer 1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ`
   ![AuthToken](https://hunterxp.ru/playkey/docs_generator/token.png)

5. `1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ` - это и есть ваш токен авторизации (храните его в секрете!)

### При попытке запустить файл run_npm_install.bat я получаю предупреждение SmartScreen об опасности

Это нормальное поведение Windows 10+, для обеспечения безопасности:
![Windows SmartScreen Warning](https://hunterxp.ru/playkey/docs_generator/windows_warning.png)

Исходный код проекта - открыт, и вы можете сами убедиться, что никаких опасных команд и манипуляций там нет.

Чтобы продолжить запуск - нажмите кнопку "Подробнее", и далее кнопку "Выполнить в любом случае"
![Windows SmartScreen Accept](https://hunterxp.ru/playkey/docs_generator/windows_warning2.png)

## Поддержка

Если у вас возникли вопросы или проблемы, пожалуйста, создайте issue в репозитории или свяжитесь с автором проекта в Telegram: ([@hunterxp](https://t.me/hunterxp)).
